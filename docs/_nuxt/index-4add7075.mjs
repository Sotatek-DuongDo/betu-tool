import{_ as q,d as Q,u as W,r as _,c as X,o as Y,a as g,b as c,e as S,f as j,g as V,h as e,w as n,F as M,i as Z,j as O,k as p}from"./entry-5324f15f.mjs";const $=Q({name:"index",setup(N,{expose:s}){s();const{authAdmin:C,placeMultiBet:t,placeBet:B,getFixtureDetail:U}=Z(),l=W(),i=_(!1),k=_(!1),x=[{title:"round",dataKey:"round",width:150},{title:"type",dataKey:"type",width:150},{title:"odds",dataKey:"odds",width:150},{title:"payout",dataKey:"payout",width:150},{title:"stake",dataKey:"stake",width:150},{title:"status",dataKey:"status",width:150}],f=_([]),u=_(),F=X(()=>l.users.map(o=>({value:o.username,label:o.username}))),b=_([]),v=_(!1),h=_({}),a=_(),A=async o=>{f.value=[],i.value=!0;const[r]=await o.getMyBets();f.value=r},z=async o=>{k.value=!0},L=o=>new Promise((r,m)=>{const d=new FileReader;d.onload=y=>r(y.target.result),d.onerror=y=>m(y),d.readAsText(o)}),D=o=>{try{return JSON.parse(o)}catch{return null}},P=async o=>{try{const r=await L(o.target.files[0]),m=D(r);if(!g.isArray(m))return;for(const d of m)await l.login(d.username,d.password)}finally{a.value.value=null}},T=async o=>{const r=await L(o.target.files[0]);u.value=D(r)},E=()=>{for(const o of l.users)try{o.isLogged&&o.joinRound()}catch(r){console.log(r)}},H=()=>{h.value={},v.value=!0},G=async()=>{try{await l.login(h.value.username,h.value.password),v.value=!1}catch(o){console.log(o)}},I=async()=>{const o={};let r=[];for(const m of u.value.data)o[m.fixture_id]=U(m.fixture_id).then(d=>{const y=g.get(d,"group.templates");r=[...r,...g.chain(y).map("markets").flatten().map("outcomeGroups").flatten().map("outcomes").flatten().value()]});for(const m of b.value){const d=g.find(l.users,{username:m});if(!d)return;const y="data"in u.value&&"stake"in u.value;try{y?(await Promise.all(g.map(u.value.data,async w=>{var K;await o[w.fixture_id];const R=(K=g.find(r,["id",w.bet_game_id]))==null?void 0:K.currentOdd;R&&(w.odds=R)})),await t(d.accessToken,u.value)):await B(d.accessToken,u.value)}catch(w){console.log(w)}}};Y(async()=>{await C("admin","Admin_12345"),await l.getConfigs(),g.forEach(l.users,o=>{l.login(o.username,o.password)}),b.value=l.users.map(o=>o.username)});const J={authAdmin:C,placeMultiBet:t,placeBet:B,getFixtureDetail:U,userStore:l,dialogVisible:i,dialogFormVisible:k,columns:x,gridData:f,jsonData:u,userOptions:F,userSelected:b,dialogLoginVisible:v,formLoginData:h,userFileRef:a,showMyBets:A,showBetForm:z,readFile:L,parseJsonString:D,importUsers:P,handleFileUpload:T,handleJoin:E,addUser:H,handleAddUser:G,handleBet:I};return Object.defineProperty(J,"__isScriptSetup",{enumerable:!1,value:!0}),J}}),ee={style:{"margin-bottom":"10px"}},te=p("Add user"),oe=p("Import users"),ae=p("Join All"),le={key:0},ne=p("Join"),se=p("Show bets"),ie=p("Bet"),re=p("Confirm bet"),de={class:"dialog-footer"},ue=p("Cancel"),ce=p("Add");function me(N,s,C,t,B,U){const l=c("el-button"),i=c("el-table-column"),k=c("el-table"),x=c("el-table-v2"),f=c("el-dialog"),u=c("el-select-v2"),F=c("json-viewer"),b=c("el-input"),v=c("el-form-item"),h=c("el-form");return S(),j(M,null,[V("div",null,[V("div",ee,[e(l,{type:"primary",onClick:t.addUser},{default:n(()=>[te]),_:1}),e(l,{type:"primary",onClick:s[0]||(s[0]=()=>t.userFileRef.click())},{default:n(()=>[oe]),_:1}),V("input",{ref:"userFileRef",type:"file",style:{display:"none"},onChange:t.importUsers},null,544)]),e(k,{data:t.userStore.users,border:""},{default:n(()=>[e(i,{prop:"username",label:"Username"}),e(i,{prop:"availableBalance",label:"Available balance"}),e(i,{prop:"betuHold",label:"Betu hold"}),e(i,null,{header:n(()=>[e(l,{type:"primary",size:"small",onClick:t.handleJoin},{default:n(()=>[ae]),_:1})]),default:n(({row:a})=>[a.loading!==!1?(S(),j("div",le,"Loading...")):O("",!0),a.loading===!1?(S(),j(M,{key:1},[e(l,{type:"primary",size:"small",onClick:a.joinRound},{default:n(()=>[ne]),_:2},1032,["onClick"]),e(l,{type:"primary",size:"small",onClick:A=>t.showMyBets(a)},{default:n(()=>[se]),_:2},1032,["onClick"]),e(l,{type:"primary",size:"small",onClick:A=>t.showBetForm(a)},{default:n(()=>[ie]),_:2},1032,["onClick"])],64)):O("",!0)]),_:1}),e(i,{prop:"result",label:"Result"})]),_:1},8,["data"])]),e(f,{modelValue:t.dialogVisible,"onUpdate:modelValue":s[1]||(s[1]=a=>t.dialogVisible=a),title:"All my bets"},{default:n(()=>[e(x,{data:t.gridData,columns:t.columns,width:900,height:400},{default:n(()=>[e(i,{property:"round",label:"round"}),e(i,{property:"type",label:"type"}),e(i,{property:"odds",label:"odds"}),e(i,{property:"payout",label:"payout"}),e(i,{property:"stake",label:"stake"}),e(i,{property:"status",label:"status"})]),_:1},8,["data"])]),_:1},8,["modelValue"]),e(f,{modelValue:t.dialogFormVisible,"onUpdate:modelValue":s[3]||(s[3]=a=>t.dialogFormVisible=a),title:"Bet"},{default:n(()=>[V("input",{type:"file",onChange:t.handleFileUpload},null,32),e(u,{modelValue:t.userSelected,"onUpdate:modelValue":s[2]||(s[2]=a=>t.userSelected=a),options:t.userOptions,style:{width:"240px"},multiple:"","collapse-tags":"","collapse-tags-tooltip":""},null,8,["modelValue","options"]),e(F,{value:t.jsonData},null,8,["value"]),e(l,{onClick:t.handleBet},{default:n(()=>[re]),_:1})]),_:1},8,["modelValue"]),e(f,{modelValue:t.dialogLoginVisible,"onUpdate:modelValue":s[7]||(s[7]=a=>t.dialogLoginVisible=a),title:"Add user",width:"400px"},{footer:n(()=>[V("span",de,[e(l,{onClick:s[6]||(s[6]=a=>t.dialogLoginVisible=!1)},{default:n(()=>[ue]),_:1}),e(l,{type:"primary",onClick:t.handleAddUser},{default:n(()=>[ce]),_:1})])]),default:n(()=>[e(h,{model:t.formLoginData,"label-width":"150px","label-position":"top"},{default:n(()=>[e(v,{label:"Username"},{default:n(()=>[e(b,{modelValue:t.formLoginData.username,"onUpdate:modelValue":s[4]||(s[4]=a=>t.formLoginData.username=a)},null,8,["modelValue"])]),_:1}),e(v,{label:"Password"},{default:n(()=>[e(b,{modelValue:t.formLoginData.password,"onUpdate:modelValue":s[5]||(s[5]=a=>t.formLoginData.password=a),type:"password"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])],64)}var _e=q($,[["render",me]]);export{_e as default};
